from pydantic import BaseModel, Field
from typing import List, Optional

class VulnerabilityBase(BaseModel):
    commit_name: str = Field(..., alias="name")
    vulnerability_type: str = Field(..., alias="vulnerabilitytype")
    description: str
    framework: str
    is_vulnerability_fix: bool
    runtime_or_compiletime: str
    commitdate: Optional[str] = None

    class Config:
        populate_by_name = True

class ClusteredVulnerability(VulnerabilityBase):
    """Individual record with its assigned cluster metadata."""
    cluster: int
    inferred_label: str
    silhouette_score: Optional[float] = None

class ClusterSummary(BaseModel):
    """High-level view of a single cluster group."""
    cluster_id: int
    predicted_type: str
    record_count: int
    project_names: List[str]

class ClusteringResponse(BaseModel):
    """Final API response structure."""
    status: str
    total_clusters: int
    global_silhouette_score: Optional[float]
    summary: List[ClusterSummary]
    detailed_results: List[ClusteredVulnerability]