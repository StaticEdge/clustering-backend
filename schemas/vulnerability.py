from pydantic import BaseModel, Field
from typing import List, Optional

class VulnerabilityBase(BaseModel):
    name: str
    vulnerabilitytype: str
    framework: str
    description: str
    commitdate: Optional[str] = None
    is_vulnerability_fix: bool
    runtime_or_compiletime: str

class ClusteredVulnerability(VulnerabilityBase):
    """The individual record after clustering is performed."""
    cluster: int
    inferred_label: str = Field(..., description="The semantic type assigned to the cluster")

class ClusterSummary(BaseModel):
    """A high-level view of a single cluster."""
    cluster_id: int
    predicted_vulnerability_type: str
    project_names: List[str]

class ClusteringResponse(BaseModel):
    """The final response containing all data and the summary."""
    status: str
    total_clusters: int
    summary: List[ClusterSummary]
    detailed_results: List[ClusteredVulnerability]